{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "../src/main.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n'use strict'\n\n\n############################################################################################################\nGUY                       = require 'guy'\n# { debug }                 = GUY.trm.get_loggers 'LTSORT'\n# { rpr }                   = GUY.trm\n#...........................................................................................................\n{ ct: CT, \\\n  TMP_typespace1: ts1 }   = require 'cleartype'\nLTSORT                    = require './legacy'\nlt_types                  = null\n\n\n#===========================================================================================================\n#\n#-----------------------------------------------------------------------------------------------------------\nget_lt_types = ->\n  return lt_types if lt_types?\n  #.........................................................................................................\n  lt_types =\n    #.........................................................................................................\n    lt_nodelist:\n      $isa: ( x ) ->\n        # 'list.of.nonempty.text'\n        return false unless @types.isa ts1.list, x\n        return x.every ( e ) -> @types.isa ts1.nonempty_text, e\n    #.........................................................................................................\n    lt_constructor_cfg:\n      fields:\n        loners:     'boolean'\n      default:\n        loners:     true\n    #.........................................................................................................\n    lt_add_cfg:\n      fields:\n        name:       'nonempty.text'\n        precedes:   'lt_nodelist'\n        needs:      'lt_nodelist'\n      default:\n        name:       null\n        precedes:     null\n        needs:      null\n      create: ( x ) ->\n        R           = x ? {}\n        return R unless @isa.object R\n        R.needs      ?= []\n        R.precedes   ?= []\n        R.needs       = [ R.needs,    ] unless @isa.list R.needs\n        R.precedes    = [ R.precedes, ] unless @isa.list R.precedes\n        return R\n    #.........................................................................................................\n    lt_linearize_cfg:\n      fields:\n        groups:     'boolean'\n      default:\n        groups:     false\n  #.........................................................................................................\n  return lt_types\n\n\n#===========================================================================================================\n#\n#-----------------------------------------------------------------------------------------------------------\nclass Ltsort\n\n  #---------------------------------------------------------------------------------------------------------\n  constructor: ( cfg ) ->\n    GUY.props.hide @, 'lt_types', get_lt_types()\n    @cfg = CT.create @lt_types.lt_constructor_cfg cfg\n    GUY.props.hide @, 'topograph', LTSORT.new_graph @cfg\n    GUY.props.hide @, 'precedents',  {}\n    return undefined\n\n  #---------------------------------------------------------------------------------------------------------\n  _get_relatives: ( name, relatives ) ->\n    if '*' in relatives\n      return ( relative for relative of @precedents when relative isnt name )\n    return relatives\n\n  #---------------------------------------------------------------------------------------------------------\n  add: ( cfg ) ->\n    cfg = CT.create @lt_types.lt_add_cfg cfg\n    #.......................................................................................................\n    if ( cfg.precedes.length is 0 ) and ( cfg.needs.length is 0 )\n      return @_register cfg.name\n    #.......................................................................................................\n    relatives = @_get_relatives cfg.name, cfg.needs\n    if relatives.length is 0\n      @_register cfg.name\n    else\n      @_add relative, cfg.name for relative in relatives\n    #.......................................................................................................\n    relatives = @_get_relatives cfg.name, cfg.precedes\n    if relatives.length is 0\n      @_register cfg.name\n    else\n      @_add cfg.name, relative for relative in relatives\n    #.......................................................................................................\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _register: ( name ) ->\n    @precedents[ name ] ?= []\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _add: ( name, precedent ) ->\n    @_register name\n    @_register precedent\n    @precedents[ name ].push precedent\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  _finalize: ->\n    LTSORT.clear @topograph\n    #.......................................................................................................\n    for name, precedents of @precedents\n      LTSORT.add @topograph, name\n      LTSORT.add @topograph, name, precedent for precedent in precedents\n    #.......................................................................................................\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  linearize: ( cfg ) ->\n    cfg = CT.create @lt_types.lt_linearize_cfg cfg\n    @_finalize()\n    return LTSORT.group @topograph if cfg.groups\n    return LTSORT.linearize @topograph\n\n\n\n\n# #===========================================================================================================\n# #\n# #-----------------------------------------------------------------------------------------------------------\n# show = ( topograph ) ->\n#   LTSORT                    = require '../../../apps/ltsort'\n#   try dependencies = LTSORT.group topograph catch error\n#     throw error unless ( error.message.match /detected cycle involving node/ )?\n#     warn GUY.trm.reverse error.message\n#     warn '^08-1^', GUY.trm.reverse error.message\n#     # throw new DBay_sqlm_circular_references_error '^dbay/dbm@4^', name, ref_name\n#   info '^08-2^', dependencies\n#   try ordering = LTSORT.linearize topograph catch error\n#     throw error unless ( error.message.match /detected cycle involving node/ )?\n#     warn '^08-3^', GUY.trm.reverse error.message\n#     # throw new DBay_sqlm_circular_references_error '^dbay/dbm@4^', name, ref_name\n#   table = []\n#   for [ name, precedents, ] from topograph.precedents.entries()\n#     precedents = precedents.join ', '\n#     table.push { name, precedents, }\n#   H.tabulate \"topograph\", table\n#   info '^08-4^', ( GUY.trm.yellow x for x in ordering ).join GUY.trm.grey ' => '\n#   return null\n\n\n#===========================================================================================================\nmodule.exports = { Ltsort, }\n\n\n\n"
  ]
}